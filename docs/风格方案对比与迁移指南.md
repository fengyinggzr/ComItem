# ComItem é£æ ¼æ–¹æ¡ˆå¯¹æ¯” - è§£å†³é¢„è§ˆé—®é¢˜

## ğŸ¯ é—®é¢˜ç—‡çŠ¶
- âŒ Qt Creator é¢„è§ˆä¸­æ— æ³•æ˜¾ç¤ºé£æ ¼
- âŒ Qt Design Studio é¢„è§ˆä¸­æ— æ³•æ˜¾ç¤ºé£æ ¼
- âœ… è¿è¡Œæ—¶æ˜¾ç¤ºæ­£å¸¸

**æ ¹æœ¬åŸå› **: `pragma Singleton` åœ¨è®¾è®¡å™¨é¢„è§ˆå¼•æ“ä¸­ä¸å¯é 

---

## ğŸ’¡ ä¸‰ç§æ›¿ä»£æ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€ï¼šAttached Propertiesï¼ˆé™„åŠ å±æ€§ï¼‰â­â­â­

**ä¼˜ç‚¹**:
- âœ… è®¾è®¡å™¨é¢„è§ˆå®Œå…¨æ”¯æŒ
- âœ… è¯­æ³•ä¼˜é›…ï¼Œç±»ä¼¼ `Material.primary`
- âœ… æ€§èƒ½æœ€ä¼˜ï¼ˆä¸åˆ›å»ºå¤šä½™å¯¹è±¡ï¼‰
- âœ… ç¬¦åˆ Qt å®˜æ–¹æ¨è

**ä½¿ç”¨æ–¹å¼**:
```qml
import ComItem

Button {
    font.pixelSize: ComTheme.fontSizeMedium
    background: Rectangle {
        color: ComTheme.primary
        radius: ComTheme.radiusMedium
    }
}
```

**å®æ–½æ­¥éª¤**:
1. å·²åˆ›å»º `ComThemeAttached.h` å’Œ `ComThemeAttached.cpp`
2. CMake ä¼šè‡ªåŠ¨æ‰«æå¹¶ç¼–è¯‘
3. é‡æ–°æ„å»ºé¡¹ç›®å³å¯ä½¿ç”¨

---

### æ–¹æ¡ˆäºŒï¼šå†…è”æ ·å¼ï¼ˆæœ€ç®€å•ï¼‰â­â­â­

**ä¼˜ç‚¹**:
- âœ… 100% å¯é ï¼ˆä¸ä¾èµ–ä»»ä½•å¤–éƒ¨å¯¹è±¡ï¼‰
- âœ… è®¾è®¡å™¨é¢„è§ˆå®Œç¾æ”¯æŒ
- âœ… é›¶é…ç½®ï¼Œç«‹å³å¯ç”¨
- âœ… é€‚åˆç‹¬ç«‹ç»„ä»¶

**ç¼ºç‚¹**:
- âš ï¸ æ¯ä¸ªç»„ä»¶é‡å¤å®šä¹‰é¢œè‰²
- âš ï¸ ä¿®æ”¹ä¸»é¢˜éœ€è¦æ›´æ–°å¤šä¸ªæ–‡ä»¶

**ä½¿ç”¨æ–¹å¼**:
```qml
Button {
    readonly property color themePrimary: "#6366f1"
    readonly property color themePrimaryHover: "#4f46e5"
    
    background: Rectangle {
        color: root.hovered ? themePrimaryHover : themePrimary
    }
}
```

**ç¤ºä¾‹**: æŸ¥çœ‹ `ComButton3_InlineStyle.qml`

---

### æ–¹æ¡ˆä¸‰ï¼šQtObject å®ä¾‹â­â­

**ä¼˜ç‚¹**:
- âœ… è®¾è®¡å™¨é¢„è§ˆæ”¯æŒè¾ƒå¥½
- âœ… å¯ä»¥ç»Ÿä¸€ç®¡ç†ä¸»é¢˜
- âœ… æ˜“äºç†è§£å’Œç»´æŠ¤

**ç¼ºç‚¹**:
- âš ï¸ æ¯ä¸ªç»„ä»¶å®ä¾‹åŒ–ä¸€ä¸ªä¸»é¢˜å¯¹è±¡ï¼ˆè½»å¾®æ€§èƒ½å¼€é”€ï¼‰
- âš ï¸ éœ€è¦æ‰‹åŠ¨åˆ›å»º `property var theme: ComThemeInstance {}`

**ä½¿ç”¨æ–¹å¼**:
```qml
import ComItem

Button {
    property var theme: ComThemeInstance {}
    
    background: Rectangle {
        color: theme.primary
    }
}
```

**ç¤ºä¾‹**: æŸ¥çœ‹ `ComButton4_InstanceStyle.qml`

---

## ğŸ“Š æ–¹æ¡ˆå¯¹æ¯”è¡¨

| ç‰¹æ€§ | å•ä¾‹ Singleton | Attached Properties | å†…è”æ ·å¼ | QtObject å®ä¾‹ |
|------|---------------|---------------------|---------|--------------|
| **é¢„è§ˆæ”¯æŒ** | âŒ ä¸å¯é  | âœ… å®Œç¾ | âœ… å®Œç¾ | âœ… è‰¯å¥½ |
| **æ€§èƒ½** | â­â­â­ æœ€ä¼˜ | â­â­â­ æœ€ä¼˜ | â­â­â­ æœ€ä¼˜ | â­â­ æ¯ç»„ä»¶ä¸€ä¸ªå¯¹è±¡ |
| **ä»£ç ä¼˜é›…åº¦** | â­â­â­ | â­â­â­ | â­ é‡å¤ä»£ç å¤š | â­â­ |
| **ç»´æŠ¤æˆæœ¬** | â­â­â­ é›†ä¸­ç®¡ç† | â­â­â­ é›†ä¸­ç®¡ç† | âš ï¸ åˆ†æ•£åœ¨å„ç»„ä»¶ | â­â­ é›†ä¸­ç®¡ç† |
| **å®æ–½éš¾åº¦** | ç®€å• | ä¸­ç­‰ï¼ˆéœ€ C++ï¼‰ | æç®€å• | ç®€å• |
| **Qt å®˜æ–¹æ¨è** | âŒ é¢„è§ˆé—®é¢˜ | âœ… æ¨è | - | - |

---

## ğŸš€ æ¨èå®æ–½æ–¹æ¡ˆ

### çŸ­æœŸæ–¹æ¡ˆï¼ˆç«‹å³å¯ç”¨ï¼‰ï¼šæ–¹æ¡ˆäºŒ - å†…è”æ ·å¼

**é€‚åˆåœºæ™¯**: 
- éœ€è¦ç«‹å³è§£å†³é¢„è§ˆé—®é¢˜
- ç»„ä»¶æ•°é‡è¾ƒå°‘
- ä¸éœ€è¦é¢‘ç¹ä¿®æ”¹ä¸»é¢˜

**å®æ–½æ–¹æ³•**:
ç›´æ¥å°†ç°æœ‰ç»„ä»¶æ”¹ä¸ºå†…è”æ ·å¼ï¼Œå‚è€ƒ `ComButton3_InlineStyle.qml`

### é•¿æœŸæ–¹æ¡ˆï¼ˆæœ€ä½³å®è·µï¼‰ï¼šæ–¹æ¡ˆä¸€ - Attached Properties

**é€‚åˆåœºæ™¯**:
- æ­£å¼é¡¹ç›®
- éœ€è¦ç»Ÿä¸€ä¸»é¢˜ç®¡ç†
- è¿½æ±‚æœ€ä½³æ€§èƒ½å’Œä»£ç è´¨é‡

**å®æ–½æ–¹æ³•**:
1. æ„å»ºé¡¹ç›®ï¼ˆå·²åŒ…å« ComThemeAttachedï¼‰
2. æ›´æ–°ç°æœ‰ç»„ä»¶ä½¿ç”¨é™„åŠ å±æ€§
3. ä» qmldir ä¸­ç§»é™¤å•ä¾‹å£°æ˜

---

## ğŸ“ è¿ç§»æŒ‡å—

### ä»å•ä¾‹è¿ç§»åˆ° Attached Properties

**æ­¥éª¤ 1**: ç¡®è®¤ ComThemeAttached å·²ç¼–è¯‘
```powershell
cmake --build build --config Debug
```

**æ­¥éª¤ 2**: æ›´æ–° qmldirï¼ˆç§»é™¤å•ä¾‹ï¼‰
```diff
module ComItem
optional plugin ComItemplugin
classname ComItemPlugin
- singleton ComTheme 1.0 ComTheme.qml
```

**æ­¥éª¤ 3**: ç»„ä»¶ä»£ç æ— éœ€ä¿®æ”¹
```qml
// è¯­æ³•å®Œå…¨ç›¸åŒï¼
color: ComTheme.primary  // Attached property è‡ªåŠ¨å¯ç”¨
```

**æ­¥éª¤ 4**: åˆ é™¤æ—§çš„å•ä¾‹æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰
```powershell
# å¯ä»¥ä¿ç•™ ComTheme.qml ä½œä¸ºæ–‡æ¡£å‚è€ƒ
```

---

### ä»å•ä¾‹è¿ç§»åˆ°å†…è”æ ·å¼

**ç¤ºä¾‹è½¬æ¢**:

**ä¿®æ”¹å‰**:
```qml
Button {
    background: Rectangle {
        color: ComTheme.primary
        radius: ComTheme.radiusMedium
    }
}
```

**ä¿®æ”¹å**:
```qml
Button {
    readonly property color themePrimary: "#6366f1"
    readonly property int themeRadiusMedium: 6
    
    background: Rectangle {
        color: themePrimary
        radius: themeRadiusMedium
    }
}
```

---

## ğŸ§ª æµ‹è¯•æ–¹æ³•

### æµ‹è¯•æ–‡ä»¶
å·²åˆ›å»º: `example/StyleComparisonTest.qml`

### æµ‹è¯•æ­¥éª¤
1. æ„å»ºé¡¹ç›®
2. åœ¨ Qt Design Studio ä¸­æ‰“å¼€ `StyleComparisonTest.qml`
3. åˆ‡æ¢åˆ°**è®¾è®¡æ¨¡å¼**é¢„è§ˆ
4. æ£€æŸ¥å“ªç§æ–¹æ¡ˆçš„æŒ‰é’®æ˜¾ç¤ºè“ç´«è‰²é£æ ¼

### é¢„æœŸç»“æœ
- âŒ åŸå§‹å•ä¾‹ç‰ˆæœ¬ï¼šå¯èƒ½ä¸æ˜¾ç¤ºé¢œè‰²
- âœ… Attached Propertiesï¼šæ˜¾ç¤ºè“ç´«è‰²
- âœ… å†…è”æ ·å¼ï¼šæ˜¾ç¤ºè“ç´«è‰²
- âœ… QtObject å®ä¾‹ï¼šæ˜¾ç¤ºè“ç´«è‰²

---

## ğŸ”§ å…·ä½“å®æ–½å»ºè®®

### å»ºè®®é‡‡ç”¨ï¼šæ–¹æ¡ˆä¸€ï¼ˆAttached Propertiesï¼‰

**åŸå› **:
1. è¿™æ˜¯ Qt Quick Controls 2 Material/Universal é£æ ¼çš„æ ‡å‡†åšæ³•
2. å®Œå…¨å…¼å®¹è®¾è®¡å™¨é¢„è§ˆ
3. æ€§èƒ½æœ€ä¼˜ï¼Œæ— é¢å¤–å¯¹è±¡åˆ›å»º
4. ä»£ç ç®€æ´ï¼Œä½¿ç”¨æ–¹å¼ä¸å•ä¾‹ç›¸åŒ

**ç«‹å³è¡ŒåŠ¨**:
```powershell
# 1. é‡æ–°æ„å»ºï¼ˆåŒ…å« ComThemeAttachedï¼‰
cmake --build build --config Debug

# 2. æµ‹è¯•
cd example
qml StyleComparisonTest.qml

# 3. å¦‚æœ Attached ç‰ˆæœ¬æ˜¾ç¤ºæ­£å¸¸ï¼Œå°±å¯ä»¥è¿ç§»æ‰€æœ‰ç»„ä»¶
```

**è¿ç§»ç°æœ‰ç»„ä»¶**:
- `ComButton.qml` â†’ ä¿æŒä¸å˜ï¼ˆè¯­æ³•å®Œå…¨ç›¸åŒï¼ï¼‰
- `ComTextField.qml` â†’ ä¿æŒä¸å˜
- `ComCheckBox.qml` â†’ ä¿æŒä¸å˜
- åªéœ€æ›´æ–° qmldir ç§»é™¤ singleton å£°æ˜

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **Attached Properties éœ€è¦é‡æ–°æ„å»º**: ç¡®ä¿ C++ ä»£ç å·²ç¼–è¯‘
2. **qmldir å†²çª**: ä¸èƒ½åŒæ—¶ä¿ç•™ singleton å’Œ attached çš„å£°æ˜
3. **æµ‹è¯•å…ˆè¡Œ**: ä½¿ç”¨ `StyleComparisonTest.qml` ç¡®è®¤æ•ˆæœ
4. **æ¸è¿›è¿ç§»**: å¯ä»¥å…ˆæµ‹è¯•ä¸€ä¸ªç»„ä»¶ï¼Œç¡®è®¤æ— è¯¯åå†å…¨éƒ¨è¿ç§»

---

## ğŸ“š ç›¸å…³æ–‡ä»¶

- `cpp/ComThemeAttached.h` - Attached Properties å®ç°
- `cpp/ComThemeAttached.cpp` - å®ç°æ–‡ä»¶
- `qml/ComButton2_AttachedStyle.qml` - Attached ç¤ºä¾‹
- `qml/ComButton3_InlineStyle.qml` - å†…è”æ ·å¼ç¤ºä¾‹
- `qml/ComButton4_InstanceStyle.qml` - å®ä¾‹åŒ–ç¤ºä¾‹
- `qml/ComThemeInstance.qml` - éå•ä¾‹ä¸»é¢˜å¯¹è±¡
- `example/StyleComparisonTest.qml` - å¯¹æ¯”æµ‹è¯•
